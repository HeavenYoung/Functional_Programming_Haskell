<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : DataTypes
Description : This is a module to do all Network request
Copyright   : (c) 
                  Tian Yang, 
                  Nansu Wang,
                  Ziqi Zheng,
                  Yizhuo Zhang,
License     : GPL-3
Maintainer  : Yang Tian (ml191028@qmul.ac.uk)
Stability   : experimental
Portability : POSIX
-}</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">HTTPRequest</span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="HTTPRequest.html#loadMovieList"><span class="hs-identifier">loadMovieList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>      </span><span class="annot"><a href="HTTPRequest.html#loadActorList"><span class="hs-identifier">loadActorList</span></a></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="DataTypes.html"><span class="hs-identifier">DataTypes</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="DataTypes.html#Actor"><span class="hs-identifier">Actor</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="DataTypes.html#Movie"><span class="hs-identifier">Movie</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="ParserTool.html"><span class="hs-identifier">ParserTool</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="ParserTool.html#parseActors"><span class="hs-identifier">parseActors</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ParserTool.html#parseMovies"><span class="hs-identifier">parseMovies</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ParserTool.html#parsePages"><span class="hs-identifier">parsePages</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GlobalTool.html"><span class="hs-identifier">GlobalTool</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-operator">(&lt;=&lt;)</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Network.HTTP.Conduit</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NHC</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LB</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">handle</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Time</span></span><span>
</span><span id="line-29"></span><span class="hs-comment">-- import Formatting</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-comment">-- | get all movie from a given date</span><span>
</span><span id="line-32"></span><span class="annot"><a href="HTTPRequest.html#loadMovieList"><span class="hs-identifier hs-type">loadMovieList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="DataTypes.html#Movie"><span class="hs-identifier hs-type">Movie</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-33"></span><span id="loadMovieList"><span class="annot"><span class="annottext">loadMovieList :: String -&gt; IO [Movie]
</span><a href="HTTPRequest.html#loadMovieList"><span class="hs-identifier hs-var hs-var">loadMovieList</span></a></span></span><span> </span><span id="local-6989586621679138107"><span class="annot"><span class="annottext">fromDate :: String
</span><a href="#local-6989586621679138107"><span class="hs-identifier hs-var">fromDate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679138106"><span class="annot"><span class="annottext">movieHandle :: HttpException -&gt; IO ByteString
</span><a href="#local-6989586621679138106"><span class="hs-identifier hs-var hs-var">movieHandle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679138105"><span class="annot"><span class="annottext">e :: HttpException
</span><a href="#local-6989586621679138105"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; IO ByteString
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier hs-var">LB.empty</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NHC.HttpException</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LB.ByteString</span></span><span>
</span><span id="line-36"></span><span>  </span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-comment">-- get total_pages</span><span>
</span><span id="line-38"></span><span>  </span><span id="local-6989586621679138103"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679138103"><span class="hs-identifier hs-var">totolPages</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Int) -&gt; IO ByteString -&gt; IO Int
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><a href="ParserTool.html#parsePages"><span class="hs-identifier hs-var">parsePages</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(HttpException -&gt; IO ByteString) -&gt; IO ByteString -&gt; IO ByteString
forall e a. Exception e =&gt; (e -&gt; IO a) -&gt; IO a -&gt; IO a
</span><span class="hs-identifier hs-var">handle</span></span><span> </span><span class="annot"><span class="annottext">HttpException -&gt; IO ByteString
</span><a href="#local-6989586621679138106"><span class="hs-identifier hs-var">movieHandle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; IO ByteString
forall (m :: * -&gt; *). MonadIO m =&gt; String -&gt; m ByteString
</span><span class="hs-identifier hs-var">NHC.simpleHttp</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ByteString) -&gt; IO String -&gt; IO ByteString
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; IO String
</span><a href="HTTPRequest.html#getMovieRequestURL"><span class="hs-identifier hs-var">getMovieRequestURL</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679138107"><span class="hs-identifier hs-var">fromDate</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-comment">-- print totolPages</span><span>
</span><span id="line-40"></span><span>  </span><span id="local-6989586621679138099"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679138099"><span class="hs-identifier hs-var">requestList</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; IO ByteString) -&gt; [Int] -&gt; IO [ByteString]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; IO ByteString
forall (m :: * -&gt; *). MonadIO m =&gt; String -&gt; m ByteString
</span><span class="hs-identifier hs-var">NHC.simpleHttp</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ByteString)
-&gt; (Int -&gt; IO String) -&gt; Int -&gt; IO ByteString
forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; IO String
</span><a href="HTTPRequest.html#getMovieRequestURL"><span class="hs-identifier hs-var">getMovieRequestURL</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679138107"><span class="hs-identifier hs-var">fromDate</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679138103"><span class="hs-identifier hs-var">totolPages</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-comment">-- concatenate all response</span><span>
</span><span id="line-43"></span><span>  </span><span class="annot"><span class="annottext">[Movie] -&gt; IO [Movie]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([Movie] -&gt; IO [Movie]) -&gt; [Movie] -&gt; IO [Movie]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; [Movie]) -&gt; [ByteString] -&gt; [Movie]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [Movie]
</span><a href="ParserTool.html#parseMovies"><span class="hs-identifier hs-var">parseMovies</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679138099"><span class="hs-identifier hs-var">requestList</span></a></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-comment">-- | produces the URL for the API call from a given date and a page number. before using the tMDB , we need to register a key</span><span>
</span><span id="line-46"></span><span class="annot"><a href="HTTPRequest.html#getMovieRequestURL"><span class="hs-identifier hs-type">getMovieRequestURL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-47"></span><span id="getMovieRequestURL"><span class="annot"><span class="annottext">getMovieRequestURL :: String -&gt; Int -&gt; IO String
</span><a href="HTTPRequest.html#getMovieRequestURL"><span class="hs-identifier hs-var hs-var">getMovieRequestURL</span></a></span></span><span> </span><span id="local-6989586621679138096"><span class="annot"><span class="annottext">fromDate :: String
</span><a href="#local-6989586621679138096"><span class="hs-identifier hs-var">fromDate</span></a></span></span><span> </span><span id="local-6989586621679138095"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621679138095"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-comment">-- date &lt;- getCurrentTime</span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-comment">-- print (utctDay date)</span><span>
</span><span id="line-51"></span><span>  </span><span>
</span><span id="line-52"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; IO String
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO String) -&gt; String -&gt; IO String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;https://api.themoviedb.org/3/discover/movie?api_key=&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>                   </span><span class="annot"><span class="hs-string">&quot;75bdf334ec04a7656cf07bd238d48036&amp;language=en-US&amp;sort_by=&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>                   </span><span class="annot"><span class="hs-string">&quot;popularity.desc&amp;include_adult=false&amp;include_video=false&amp;page=&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-55"></span><span>                   </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679138095"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;&amp;region=US&amp;primary_release_date.gte=&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679138096"><span class="hs-identifier hs-var">fromDate</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-56"></span><span>                   </span><span class="annot"><span class="hs-string">&quot;&amp;primary_release_date.lte=&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-string">&quot;2020-12-10&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-comment">-- | load actors</span><span>
</span><span id="line-59"></span><span class="annot"><a href="HTTPRequest.html#loadActorList"><span class="hs-identifier hs-type">loadActorList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="DataTypes.html#Movie"><span class="hs-identifier hs-type">Movie</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="DataTypes.html#Actor"><span class="hs-identifier hs-type">Actor</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-60"></span><span id="loadActorList"><span class="annot"><span class="annottext">loadActorList :: [Movie] -&gt; IO [Actor]
</span><a href="HTTPRequest.html#loadActorList"><span class="hs-identifier hs-var hs-var">loadActorList</span></a></span></span><span> </span><span id="local-6989586621679138092"><span class="annot"><span class="annottext">movies :: [Movie]
</span><a href="#local-6989586621679138092"><span class="hs-identifier hs-var">movies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-61"></span><span>  </span><span id="local-6989586621679138091"><span class="annot"><span class="annottext">[[Actor]]
</span><a href="#local-6989586621679138091"><span class="hs-identifier hs-var">actors</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Movie -&gt; IO [Actor]) -&gt; [Movie] -&gt; IO [[Actor]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Movie -&gt; IO [Actor]
</span><a href="HTTPRequest.html#getActorResponse"><span class="hs-identifier hs-var">getActorResponse</span></a></span><span> </span><span class="annot"><span class="annottext">[Movie]
</span><a href="#local-6989586621679138092"><span class="hs-identifier hs-var">movies</span></a></span><span>
</span><span id="line-62"></span><span>  </span><span class="annot"><span class="annottext">[Actor] -&gt; IO [Actor]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([Actor] -&gt; IO [Actor]) -&gt; [Actor] -&gt; IO [Actor]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[Actor]] -&gt; [Actor]
</span><a href="HTTPRequest.html#filterActors"><span class="hs-identifier hs-var">filterActors</span></a></span><span> </span><span class="annot"><span class="annottext">[[Actor]]
</span><a href="#local-6989586621679138091"><span class="hs-identifier hs-var">actors</span></a></span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-comment">-- | get actor response </span><span>
</span><span id="line-65"></span><span class="annot"><a href="HTTPRequest.html#getActorResponse"><span class="hs-identifier hs-type">getActorResponse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="DataTypes.html#Movie"><span class="hs-identifier hs-type">Movie</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="DataTypes.html#Actor"><span class="hs-identifier hs-type">Actor</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-66"></span><span id="getActorResponse"><span class="annot"><span class="annottext">getActorResponse :: Movie -&gt; IO [Actor]
</span><a href="HTTPRequest.html#getActorResponse"><span class="hs-identifier hs-var hs-var">getActorResponse</span></a></span></span><span> </span><span id="local-6989586621679138088"><span class="annot"><span class="annottext">m :: Movie
</span><a href="#local-6989586621679138088"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="DataTypes.html#Movie"><span class="hs-identifier hs-type">Movie</span></a></span><span> </span><span id="local-6989586621679138086"><span class="annot"><span class="annottext">movieId :: Int
</span><a href="#local-6989586621679138086"><span class="hs-identifier hs-var">movieId</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679138085"><span class="annot"><span class="annottext">actorHandle :: HttpException -&gt; IO ByteString
</span><a href="#local-6989586621679138085"><span class="hs-identifier hs-var hs-var">actorHandle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679138084"><span class="annot"><span class="annottext">e :: HttpException
</span><a href="#local-6989586621679138084"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; IO ByteString
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier hs-var">LB.empty</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NHC.HttpException</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LB.ByteString</span></span><span>
</span><span id="line-68"></span><span>  </span><span id="local-6989586621679138083"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679138083"><span class="hs-identifier hs-var">actorResponse</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(HttpException -&gt; IO ByteString) -&gt; IO ByteString -&gt; IO ByteString
forall e a. Exception e =&gt; (e -&gt; IO a) -&gt; IO a -&gt; IO a
</span><span class="hs-identifier hs-var">handle</span></span><span> </span><span class="annot"><span class="annottext">HttpException -&gt; IO ByteString
</span><a href="#local-6989586621679138085"><span class="hs-identifier hs-var">actorHandle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; IO ByteString
forall (m :: * -&gt; *). MonadIO m =&gt; String -&gt; m ByteString
</span><span class="hs-identifier hs-var">NHC.simpleHttp</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="HTTPRequest.html#getActorRequestUrl"><span class="hs-identifier hs-var">getActorRequestUrl</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679138086"><span class="hs-identifier hs-var">movieId</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>  </span><span class="annot"><span class="annottext">[Actor] -&gt; IO [Actor]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([Actor] -&gt; IO [Actor]) -&gt; [Actor] -&gt; IO [Actor]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Movie -&gt; [Actor]
</span><a href="ParserTool.html#parseActors"><span class="hs-identifier hs-var">parseActors</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679138083"><span class="hs-identifier hs-var">actorResponse</span></a></span><span> </span><span class="annot"><span class="annottext">Movie
</span><a href="#local-6989586621679138088"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-comment">-- | concatenate actor url</span><span>
</span><span id="line-72"></span><span class="annot"><a href="HTTPRequest.html#getActorRequestUrl"><span class="hs-identifier hs-type">getActorRequestUrl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-73"></span><span id="getActorRequestUrl"><span class="annot"><span class="annottext">getActorRequestUrl :: Int -&gt; String
</span><a href="HTTPRequest.html#getActorRequestUrl"><span class="hs-identifier hs-var hs-var">getActorRequestUrl</span></a></span></span><span> </span><span id="local-6989586621679138081"><span class="annot"><span class="annottext">aId :: Int
</span><a href="#local-6989586621679138081"><span class="hs-identifier hs-var">aId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;https://api.themoviedb.org/3/movie/&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679138081"><span class="hs-identifier hs-var">aId</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-74"></span><span>                          </span><span class="annot"><span class="hs-string">&quot;/credits?api_key=75bdf334ec04a7656cf07bd238d48036&quot;</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- | remove duplicted actors</span><span>
</span><span id="line-77"></span><span class="annot"><a href="HTTPRequest.html#filterActors"><span class="hs-identifier hs-type">filterActors</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="DataTypes.html#Actor"><span class="hs-identifier hs-type">Actor</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="DataTypes.html#Actor"><span class="hs-identifier hs-type">Actor</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-78"></span><span id="filterActors"><span class="annot"><span class="annottext">filterActors :: [[Actor]] -&gt; [Actor]
</span><a href="HTTPRequest.html#filterActors"><span class="hs-identifier hs-var hs-var">filterActors</span></a></span></span><span> </span><span id="local-6989586621679138080"><span class="annot"><span class="annottext">x :: [[Actor]]
</span><a href="#local-6989586621679138080"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Actor] -&gt; [Actor]
</span><a href="#local-6989586621679138079"><span class="hs-identifier hs-var">removeDups</span></a></span><span> </span><span class="annot"><span class="annottext">([Actor] -&gt; [Actor]) -&gt; [Actor] -&gt; [Actor]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[Actor]] -&gt; [Actor]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[Actor]]
</span><a href="#local-6989586621679138080"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><a href="#local-6989586621679138079"><span class="hs-identifier hs-type">removeDups</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="DataTypes.html#Actor"><span class="hs-identifier hs-type">Actor</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="DataTypes.html#Actor"><span class="hs-identifier hs-type">Actor</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-81"></span><span>    </span><span id="local-6989586621679138079"><span class="annot"><span class="annottext">removeDups :: [Actor] -&gt; [Actor]
</span><a href="#local-6989586621679138079"><span class="hs-identifier hs-var hs-var">removeDups</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-82"></span><span>    </span><span class="annot"><a href="#local-6989586621679138079"><span class="hs-identifier hs-var">removeDups</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679138078"><span class="annot"><span class="annottext">x :: Actor
</span><a href="#local-6989586621679138078"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679138077"><span class="annot"><span class="annottext">xs :: [Actor]
</span><a href="#local-6989586621679138077"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679138076"><span class="annot"><span class="annottext">dups :: ([Actor], [Actor])
</span><a href="#local-6989586621679138076"><span class="hs-identifier hs-var hs-var">dups</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Actor -&gt; [Actor] -&gt; ([Actor], [Actor])
</span><a href="#local-6989586621679138075"><span class="hs-identifier hs-var">getDups</span></a></span><span> </span><span class="annot"><span class="annottext">Actor
</span><a href="#local-6989586621679138078"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Actor
</span><a href="#local-6989586621679138078"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Actor -&gt; [Actor] -&gt; [Actor]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Actor]
</span><a href="#local-6989586621679138077"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[Actor] -&gt; Actor
</span><a href="#local-6989586621679138074"><span class="hs-identifier hs-var">concatA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Actor], [Actor]) -&gt; [Actor]
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">([Actor], [Actor])
</span><a href="#local-6989586621679138076"><span class="hs-identifier hs-var">dups</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Actor -&gt; [Actor] -&gt; [Actor]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Actor] -&gt; [Actor]
</span><a href="#local-6989586621679138079"><span class="hs-identifier hs-var">removeDups</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Actor], [Actor]) -&gt; [Actor]
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">([Actor], [Actor])
</span><a href="#local-6989586621679138076"><span class="hs-identifier hs-var">dups</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span>    </span><span class="annot"><a href="#local-6989586621679138075"><span class="hs-identifier hs-type">getDups</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="DataTypes.html#Actor"><span class="hs-identifier hs-type">Actor</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="DataTypes.html#Actor"><span class="hs-identifier hs-type">Actor</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="DataTypes.html#Actor"><span class="hs-identifier hs-type">Actor</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="DataTypes.html#Actor"><span class="hs-identifier hs-type">Actor</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>    </span><span id="local-6989586621679138075"><span class="annot"><span class="annottext">getDups :: Actor -&gt; [Actor] -&gt; ([Actor], [Actor])
</span><a href="#local-6989586621679138075"><span class="hs-identifier hs-var hs-var">getDups</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>                                       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>    </span><span class="annot"><a href="#local-6989586621679138075"><span class="hs-identifier hs-var">getDups</span></a></span><span> </span><span id="local-6989586621679138073"><span class="annot"><span class="annottext">a1 :: Actor
</span><a href="#local-6989586621679138073"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="DataTypes.html#Actor"><span class="hs-identifier hs-type">Actor</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679138071"><span class="annot"><span class="annottext">n1 :: String
</span><a href="#local-6989586621679138071"><span class="hs-identifier hs-var">n1</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679138070"><span class="annot"><span class="annottext">a2 :: Actor
</span><a href="#local-6989586621679138070"><span class="hs-identifier hs-var">a2</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="DataTypes.html#Actor"><span class="hs-identifier hs-type">Actor</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679138069"><span class="annot"><span class="annottext">n2 :: String
</span><a href="#local-6989586621679138069"><span class="hs-identifier hs-var">n2</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679138068"><span class="annot"><span class="annottext">xs :: [Actor]
</span><a href="#local-6989586621679138068"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679138071"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679138069"><span class="hs-identifier hs-var">n2</span></a></span><span>
</span><span id="line-87"></span><span>                                                          </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Actor
</span><a href="#local-6989586621679138070"><span class="hs-identifier hs-var">a2</span></a></span><span> </span><span class="annot"><span class="annottext">Actor -&gt; [Actor] -&gt; [Actor]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">([Actor], [Actor]) -&gt; [Actor]
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Actor -&gt; [Actor] -&gt; ([Actor], [Actor])
</span><a href="#local-6989586621679138075"><span class="hs-identifier hs-var">getDups</span></a></span><span> </span><span class="annot"><span class="annottext">Actor
</span><a href="#local-6989586621679138073"><span class="hs-identifier hs-var">a1</span></a></span><span> </span><span class="annot"><span class="annottext">[Actor]
</span><a href="#local-6989586621679138068"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">([Actor], [Actor]) -&gt; [Actor]
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(([Actor], [Actor]) -&gt; [Actor]) -&gt; ([Actor], [Actor]) -&gt; [Actor]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Actor -&gt; [Actor] -&gt; ([Actor], [Actor])
</span><a href="#local-6989586621679138075"><span class="hs-identifier hs-var">getDups</span></a></span><span> </span><span class="annot"><span class="annottext">Actor
</span><a href="#local-6989586621679138073"><span class="hs-identifier hs-var">a1</span></a></span><span> </span><span class="annot"><span class="annottext">[Actor]
</span><a href="#local-6989586621679138068"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>                                                          </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Actor], [Actor]) -&gt; [Actor]
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(([Actor], [Actor]) -&gt; [Actor]) -&gt; ([Actor], [Actor]) -&gt; [Actor]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Actor -&gt; [Actor] -&gt; ([Actor], [Actor])
</span><a href="#local-6989586621679138075"><span class="hs-identifier hs-var">getDups</span></a></span><span> </span><span class="annot"><span class="annottext">Actor
</span><a href="#local-6989586621679138073"><span class="hs-identifier hs-var">a1</span></a></span><span> </span><span class="annot"><span class="annottext">[Actor]
</span><a href="#local-6989586621679138068"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Actor
</span><a href="#local-6989586621679138070"><span class="hs-identifier hs-var">a2</span></a></span><span> </span><span class="annot"><span class="annottext">Actor -&gt; [Actor] -&gt; [Actor]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">([Actor], [Actor]) -&gt; [Actor]
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Actor -&gt; [Actor] -&gt; ([Actor], [Actor])
</span><a href="#local-6989586621679138075"><span class="hs-identifier hs-var">getDups</span></a></span><span> </span><span class="annot"><span class="annottext">Actor
</span><a href="#local-6989586621679138073"><span class="hs-identifier hs-var">a1</span></a></span><span> </span><span class="annot"><span class="annottext">[Actor]
</span><a href="#local-6989586621679138068"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><a href="#local-6989586621679138074"><span class="hs-identifier hs-type">concatA</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="DataTypes.html#Actor"><span class="hs-identifier hs-type">Actor</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="DataTypes.html#Actor"><span class="hs-identifier hs-type">Actor</span></a></span><span>
</span><span id="line-90"></span><span>    </span><span id="local-6989586621679138074"><span class="annot"><span class="annottext">concatA :: [Actor] -&gt; Actor
</span><a href="#local-6989586621679138074"><span class="hs-identifier hs-var hs-var">concatA</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679138067"><span class="annot"><span class="annottext">a :: Actor
</span><a href="#local-6989586621679138067"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">]</span><span>                                         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Actor
</span><a href="#local-6989586621679138067"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-91"></span><span>    </span><span class="annot"><a href="#local-6989586621679138074"><span class="hs-identifier hs-var">concatA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="DataTypes.html#Actor"><span class="hs-identifier hs-type">Actor</span></a></span><span> </span><span id="local-6989586621679138066"><span class="annot"><span class="annottext">aId1 :: Int
</span><a href="#local-6989586621679138066"><span class="hs-identifier hs-var">aId1</span></a></span></span><span> </span><span id="local-6989586621679138065"><span class="annot"><span class="annottext">n1 :: String
</span><a href="#local-6989586621679138065"><span class="hs-identifier hs-var">n1</span></a></span></span><span> </span><span id="local-6989586621679138064"><span class="annot"><span class="annottext">m1 :: [Movie]
</span><a href="#local-6989586621679138064"><span class="hs-identifier hs-var">m1</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="DataTypes.html#Actor"><span class="hs-identifier hs-type">Actor</span></a></span><span> </span><span id="local-6989586621679138063"><span class="annot"><span class="annottext">aId2 :: Int
</span><a href="#local-6989586621679138063"><span class="hs-identifier hs-var">aId2</span></a></span></span><span> </span><span id="local-6989586621679138062"><span class="annot"><span class="annottext">n2 :: String
</span><a href="#local-6989586621679138062"><span class="hs-identifier hs-var">n2</span></a></span></span><span> </span><span id="local-6989586621679138061"><span class="annot"><span class="annottext">m2 :: [Movie]
</span><a href="#local-6989586621679138061"><span class="hs-identifier hs-var">m2</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679138060"><span class="annot"><span class="annottext">xs :: [Actor]
</span><a href="#local-6989586621679138060"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Actor] -&gt; Actor
</span><a href="#local-6989586621679138074"><span class="hs-identifier hs-var">concatA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String -&gt; [Movie] -&gt; Actor
</span><a href="DataTypes.html#Actor"><span class="hs-identifier hs-var">Actor</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679138066"><span class="hs-identifier hs-var">aId1</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679138065"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Movie]
</span><a href="#local-6989586621679138064"><span class="hs-identifier hs-var">m1</span></a></span><span> </span><span class="annot"><span class="annottext">[Movie] -&gt; [Movie] -&gt; [Movie]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Movie]
</span><a href="#local-6989586621679138061"><span class="hs-identifier hs-var">m2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Actor -&gt; [Actor] -&gt; [Actor]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Actor]
</span><a href="#local-6989586621679138060"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span></pre></body></html>